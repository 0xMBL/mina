open Core

(* 
   Check

   e(p, a x + b y) = a e(p, x) + b e(p, y)
*)

open Snarkette.Mnt6753

(* 
   Check

   e(p, x + y) = e(p, x) + e(p, y)
*)
(*let check_bilinearity (p : G1.t) (x : G2.t) (y : G2.t) =
  Fq6.equal
    (Pairing.reduced_pairing p G2.(x + y))
    Fq6.(Pairing.reduced_pairing p x * Pairing.reduced_pairing p y)*)

(* TODO:

   - Sample random pts on E2 using sage
   - use G2.of_affine_coordinates and copy/paste in to this file.
   - call this function

   dune exec app/bilinearity-test/bilinearity.exe

   in src directory. *)

   let (x : G2.t)  = 
    Snarkette.Mnt6753.G2.of_affine_coordinates
    (Fq.(of_string("30986063007742648967856564566380779741111102614001869612318515913586245918745873904344885169690269815361714589506988523220416389404862524484967644707710593274802713151745219018253577581934434097119852483660930976387243276467216"), of_string("38453361429283014792583050922598063821065150936076001910188071504007332771276343651829508431101016833578608264587184359825092440027086783491091459482333545522498480031022971525027867423688403964532569843389746280382780144802591"), of_string("23888208594008153606341527617296026072357436027515238870739893106110580627552608000637324947208927593844121087067958824694565596444350471023970736945590321694089315502388321509510753343318131342603003190209689293481433776734269"))
      ,
      Fq.(of_string("29381645817004432027696879226703636810834639299135575262211681902876925974271262373422192392099518384968007661939934136439528014551733776962701230782367281308819975446359618579992037967695798693797693442330084563995080011469408"), of_string("19381649315699760816522635585134606799922346317982294066905767033105673663104078289758944254143414892311927295076318089191411118996190366998136042989534725483137694556547605598780914426657873807604845567507832453361542522672854"), of_string("9840016871116297679015880218549587018099222705139828633181164005092976397523741577036041477840141057812876303258007698651714420901140931817585463848767258816497736143807572379785934650349792972349196461060908960605413008554967"))
    )
  ;;

  let (y : G2.t) = 
    Snarkette.Mnt6753.G2.of_affine_coordinates
    (Fq.(of_string("13151983692053051352165589293379977454884763262192498717385759499829386377033159788480476393939587111562535638502999167428230319323733941602843381861926336711940083673098683385031622948778078051754857893662479708056617442970749"), of_string("35537848299443693226303676171594986424156773479052176629172509557635700700770806981248529312881235591044598048072524922353583644236116697005997945963476411606992354033959496532364286100351765828653724409876612296104925359205012"), of_string("26824982670074330887607893519550383842213211264323011770660155972212916711734650486731827903475343152325255631336514788751026661127191818958996455580738832683579809335394014789590626142285320354743025497991162206078085336385095"))
      ,
      Fq.(of_string("33866057487664085514071728300658096118168019443086631408709885471477038612399373408177785971482838189163172900594022265101965381761583689673245177724718584658991872352545059156949327402676821474970819566696153332922358312276690"), of_string("34227882683618549027238776819970287841733450062568719050982421869749881674262024899080627538974633499521509189926063901007291581512835926701853819355019666220047487583171832717270478556679882758672279901896936326626997268094397"), of_string("536500220999362974925593217880151568698591125395182656494508439777585705882604971644053057045417279247767101543213484597930697214418947113922704089063484008103155182004875966507949132481708602977431081085865740245058687899662"))
    )

  let check_on_curve t =
    let (x, y) = G2.to_affine_coordinates t in
    assert Fq3.(
      equal
        (x*x*x + G2.Coefficients.a * x + G2.Coefficients.b)
        (y * y)
    )
