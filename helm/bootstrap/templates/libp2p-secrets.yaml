{{- $root := . -}}
{{- range $pubkey, $_ := $root.Files.Glob (printf "%s" .Values.libP2pKeys.glob) }}
{{- $privkey := trimSuffix (ext $pubkey) $pubkey }}
{{- $secretName := trimPrefix "keys/libp2p-keys-example/" $privkey }}
---
kind: Secret
apiVersion: v1
metadata:
  name: {{ printf "%s" $secretName }}-key
  labels:
    {{- include "bootstrap.labels" $root | nindent 4 }}
data:
  key: |-
    {{ $root.Files.Get $privkey | b64enc | indent 4 }}
  pub: |-
    {{ $root.Files.Get $pubkey | b64enc | indent 4 }}
{{- end }}